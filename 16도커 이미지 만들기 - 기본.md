# 16도커 이미지 만들기 - 기본

## 1. git 설치

```
$ docker run -it --name git ubuntu:latest bash
$ git
bash: git: command not found
$ apt-get update
$ apt-get install -y git
$ git --version
git version 2.34.1
```

## 2. docker commit

```
$ exit
$ docker commit git ubuntu:git
sha256:61abb93ddf11164a581925ee59963aa96bae9fa25a2e3bf20422f2a3c0c67721
$ docker images
REPOSITORY   TAG       IMAGE ID       CREATED          SIZE
ubuntu       git       61abb93ddf11   23 seconds ago   189MB
ubuntu       latest    df5de72bdb3b   10 days ago      77.8MB
# ubuntu:git 이미지로 git2 컨테이너 생성
$ docker run -it --name git2 ubuntu:git bash
# ubuntu:latest 이미지에는 git이 없지만 ubuntu:git 이미지에는 git이 설치되어 있음
$ git --version
git version 2.34.1
```

## 3. docker image build

```
# docker build -t [NAME]/[IMAGE NAME]:[TAG] [BUILD CONTEXT]
$ docker build -t idealful/ubuntu:latest .
# TDD 하듯이 빌드는 한 번에 성공하지 않는다. 녹색불(빌드 성공)이 될때까지 많은 빨간불(빌드 실패)를 경험한다. 성공 이후에도 리팩토링을 통해 더 최적화 된 이미지를 생성할 수도 있다.
```

## 4. .dockerignore

.gitignore와 비슷한 역할
도커 빌드 컨텍스트에서 지정된 패턴의 파일을 무시
git이나 민감한 정보를 제외하는 용도로 주로 사용
git이나 에셋 디렉터리만 제외시켜도 빌드 속도 개선
이미지 빌드 시에 사용하는 파일은 제외시키면 안 됨

## 5. 경로 생성 및 이동

```
$ mkdir git
$ cd git
```

## 6. Dockerfile 생성

```
FROM ubuntu:latest

RUN apt-get update
RUN apt-get install -y git
```

## 7. Dockerfile에 의해 ubuntu:git-dockerfile image 생성

```
$ docker build -t ubuntu:git-dockerfile .
```

## 8. docker run으로 git 설치 여부 확인

```
$ docker run -it --name git3 ubuntu:git-dockerfile bash
$ git --version
git version 2.34.1
```
